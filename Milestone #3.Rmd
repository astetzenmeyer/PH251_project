---
title: 'Milestone #3'
author: "Virginia Chan, Patrick Traynor, Antoinette Stetzenmeyer"
date: "11/4/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#load libraries
library(tidyverse)
library(lubridate)

```



```{r}

library(readr)
cov_vax_admin <- read_csv("cov_vax_admin.csv")
cov_vax_admin

ca_county_demographics <- read_csv("ca_county_demographics.csv")
ca_county_demographics



```


```{r}

unique(cov_vax_admin$as_of_date)

```

\newpage 
#1 Subset rows or columns, as needed
```{r}

#Subset cov_vax_admin dataset by county and recent dates (September 2021)
total_age12andabove_california_county<- cov_vax_admin %>%
  select(c(as_of_date, zip_code_tabulation_area, county, vaccine_equity_metric_quartile, age12_plus_population, persons_fully_vaccinated)) %>%
  filter(as_of_date ==  "9/7/2021"| as_of_date == "9/14/2021") %>%
  group_by(county) %>%
  arrange(county)%>%
summarize(total_age12andabove = sum(age12_plus_population,na.rm = TRUE), median_of_age_12_and_above = median(age12_plus_population, na.rm = TRUE))


```

```{r}

#Patrick: this is simply another data set with a fwe more rows and taking the as
#of date a bit earlier in the event the latest date of 9/14 would exclude some
#counties - just in case. 

total_age12andabove_california_as_of_8_14_21 <- cov_vax_admin %>%
  filter(as_of_date == "8/24/2021") %>%
  group_by(county)%>%
summarize(total_age12andabove = sum(age12_plus_population,na.rm = TRUE), median_of_age_12_and_above = median(age12_plus_population, na.rm = TRUE), miniumum_age_of_12_and_above = min(age12_plus_population, na.rm = TRUE), maximum_age_of_12_and_above = max(age12_plus_population, na.rm = TRUE))

```

\newpage 

#2 Create new variables needed for analysis (minimum 2)
New variables should be created based on existing columns; for example
Calculating a rate, 
Combining character strings 
Etc
If no new values are needed for final tables/graphs, please create 2 new variables anyway


```{r}

```

\newpage 

#3 Clean variables needed for analysis (minimum 2)
Examples
Recode invalid values
Handle missing fields
Recode categories
Etc.
If not needed for final analysis, please create at least 2 new variables anyway


```{r}
#Patrick: I am just trying to pick some variable names 
#in a data set so that we can demonstrate cleaning. This is one way to clean
# in the event we wish to merge data sets. The keyed variables need to be all
# lower or upper or a merge will not work.
cleaned_cov_vax_admin <- cov_vax_admin %>%
  rename_with(., ~tolower(gsub(" ","_", .x, fixed = T)))
```

\newpage 

#4 Data dictionary based on clean dataset (minimum 4 data elements), including:
Variable name
Data type
Description

```{r}
#Patrick this is format. We will professionalize it later perhaps using kable
data_dict_for <- data.frame(Variable_Name = c("county","total_age12adnaabove",
                                              "median_of_age_12_and_above",
                                              "minimumm_age_of_12_and_above",
                                              "maximum_age_of_12_and_above"),
                            Data_Type = c("String","Numeric","Numeric",
                                          "Numeric","Numeric"),
                            Description = c("County Name",
                                            "Total number of vaccinated people as of 8/14/21",
                                           "Median vaccinated as of 8/14/21",
                                           "Minimum vaccinated as of 8/14/21",
                                           "Maximum vaccinated as of 8/14/21"), stringsAsFactors = F)

str(total_age12andabove_california_as_of_8_14_21)
  
```

\newpage 

#5 One or more tables with descriptive statistics for 4 data elements


```{r}
#e.g., mean, median, max, etc. and what they mean.
str(total_age12andabove_california_as_of_8_14_21)
summary(total_age12andabove_california_as_of_8_14_21$total_age12andabove)
```

\newpage 

#6 PDF that is professionally prepared for presentation
Each part of the milestone is clearly on one page (use \newpage to push to a new page)
Only the necessary information is outputted (you should suppress, for example, entire data frame outputs)
Use of headers and sub headers to create an organized document

